---
title: JavaScript ä¸­çš„ä½œç”¨åŸŸä¸é—­åŒ…
tags: [JavaScript, é—­åŒ…, ä½œç”¨åŸŸ]
---

## ğŸ“Œ ä¸€ã€ä½œç”¨åŸŸ Scope æ˜¯ä»€ä¹ˆï¼Ÿ

ä½œç”¨åŸŸæ˜¯æŒ‡**å˜é‡çš„å¯è®¿é—®èŒƒå›´**ã€‚

JavaScript æœ‰ä»¥ä¸‹å‡ ç§ä½œç”¨åŸŸï¼š

- **å…¨å±€ä½œç”¨åŸŸï¼ˆGlobalï¼‰**
- **å‡½æ•°ä½œç”¨åŸŸï¼ˆFunctionï¼‰**
- **å—çº§ä½œç”¨åŸŸï¼ˆBlockï¼‰**ï¼ˆES6 å¼•å…¥çš„ let / constï¼‰

ä½œç”¨åŸŸé“¾æ˜¯å˜é‡æŸ¥æ‰¾çš„è¿‡ç¨‹ï¼š**ä»å½“å‰ä½œç”¨åŸŸå‘å¤–ä¸€å±‚ä¸€å±‚æŸ¥æ‰¾ï¼Œç›´åˆ°å…¨å±€ä½œç”¨åŸŸ**ã€‚

---

## ğŸ§  äºŒã€é—­åŒ… Closure æ˜¯ä»€ä¹ˆï¼Ÿ

é—­åŒ… = **å‡½æ•° + å…¶è¯æ³•ä½œç”¨åŸŸ**

> **é—­åŒ…çš„æœ¬è´¨ï¼šå‡½æ•°â€œè®°ä½â€äº†å®ƒè¢«åˆ›å»ºæ—¶çš„ä½œç”¨åŸŸï¼Œå³ä½¿å‡½æ•°åœ¨å½“å‰ä½œç”¨åŸŸå¤–æ‰§è¡Œï¼Œä¹Ÿèƒ½è®¿é—®åŸä½œç”¨åŸŸä¸­çš„å˜é‡ã€‚**

å…¸å‹åœºæ™¯ï¼š

```js
function outer() {
  let count = 0;
  return function inner() {
    count++;
    return count;
  };
}

const counter = outer();
console.log(counter()); // 1
console.log(counter()); // 2
```
## ğŸ’¡ ä¸‰ã€é¢è¯•çœŸé¢˜ï¼šè¾“å‡ºä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ
é¢˜ç›®ä¸€ï¼š
```js
for (var i = 0; i < 3; i++) {
  setTimeout(() => console.log(i), 0);
}
```

âœ… ç­”æ¡ˆï¼š
3
3
3
ğŸ” è§£æï¼š
var æ²¡æœ‰å—çº§ä½œç”¨åŸŸï¼Œi æ˜¯å…±äº«çš„ä¸€ä¸ªå˜é‡ã€‚

æ‰€æœ‰å›è°ƒå‡½æ•°åœ¨ä¸»çº¿ç¨‹æ‰§è¡Œå®Œåæ‰§è¡Œï¼Œæ­¤æ—¶ i = 3ï¼Œæ‰€ä»¥æ‰“å°äº†ä¸‰æ¬¡ 3ã€‚

ğŸ§ª é¢˜ç›®äºŒï¼ˆé—­åŒ…ç”Ÿæˆç§æœ‰å˜é‡ï¼‰ï¼š
```js
function makeCounter() {
  let count = 0;
  return function () {
    return ++count;
  };
}

const counter1 = makeCounter();
const counter2 = makeCounter();

console.log(counter1()); // ?
console.log(counter1()); // ?
console.log(counter2()); // ?

```
âœ… ç­”æ¡ˆï¼š
1
2
1

ğŸ” è§£æï¼š
æ¯æ¬¡è°ƒç”¨ makeCounter() ä¼šè¿”å›ä¸€ä¸ªæ–°çš„é—­åŒ…å®ä¾‹ã€‚

å®ƒä»¬å„è‡ªæ‹¥æœ‰ç‹¬ç«‹çš„ count å˜é‡ã€‚

## ğŸš« å››ã€å¸¸è§è¯¯åŒº
| è¯¯åŒº             | æ­£è§£                           |
| -------------- | ---------------------------- |
| é—­åŒ… = ä»»æ„åµŒå¥—å‡½æ•°    | âŒ ä¸å‡†ç¡®ï¼Œåªæœ‰**è®¿é—®å¤–éƒ¨å˜é‡**çš„å†…éƒ¨å‡½æ•°æ‰æ„æˆé—­åŒ… |
| é—­åŒ…ä¼šè‡ªåŠ¨å¯¼è‡´å†…å­˜æ³„æ¼    | âŒ ä¸æ˜¯è‡ªåŠ¨ï¼Œå†…å­˜æ³„æ¼åªä¼šå‘ç”Ÿåœ¨ä¸é‡Šæ”¾å¼•ç”¨çš„å‰æä¸‹    |
| ä½¿ç”¨ `var` ä¸ä¼šæœ‰é—®é¢˜ | âŒ å®ƒæ²¡æœ‰å—ä½œç”¨åŸŸï¼Œä¼šå¯¼è‡´å¾ªç¯ä½“ä¸­é—­åŒ…è®¿é—®çš„æ˜¯åŒä¸€ä¸ªå˜é‡ |


## âœï¸ äº”ã€æ‰‹å†™ç»å…¸é—­åŒ…é¢˜
å°è£…ä¸€ä¸ªå…·æœ‰ç§æœ‰å˜é‡çš„æ¨¡å—ï¼š
```js
function createUser() {
  let name = 'Kaykay';
  return {
    getName() {
      return name;
    },
    setName(newName) {
      name = newName;
    },
  };
}

const user = createUser();
console.log(user.getName()); // Kaykay
user.setName('AI');
console.log(user.getName()); // AI
```
## ğŸ§± å…­ã€é¢è¯•ä¸­å¦‚ä½•è®²é—­åŒ…ï¼ˆå»ºè®®è¡¨è¾¾ï¼‰
â€œé—­åŒ…æ˜¯å‡½æ•°ä¸å…¶è¯æ³•ä½œç”¨åŸŸçš„ç»„åˆâ€

â€œå¸¸ç”¨äºæ•°æ®ç¼“å­˜ã€ç§æœ‰å˜é‡å°è£…ã€å¼‚æ­¥å¾ªç¯å˜é‡æ•è·â€

â€œåˆç†ä½¿ç”¨é—­åŒ…å¯ä»¥å¢å¼ºæ¨¡å—åŒ–ï¼›ä½†æ³¨æ„é—­åŒ…ç”Ÿå‘½å‘¨æœŸï¼Œé¿å…å†…å­˜æ³„æ¼â€

## ğŸ“š ä¸ƒã€å»¶ä¼¸é˜…è¯»
ã€Šä½ ä¸çŸ¥é“çš„JavaScriptï¼ˆä¸Šå·ï¼‰ã€‹ç¬¬ 1ã€2 ç« 

MDNï¼šé—­åŒ…

LeetCode é¢˜ï¼šJS é—­åŒ…å®ç°ç¼“å­˜å‡½æ•°ã€æ¨¡æ‹Ÿ onceã€debounce ç­‰

ğŸ§­ ä¸‹ä¸€ç¯‡å»ºè®®é˜…è¯»ï¼šthis æŒ‡å‘ä¸ç»‘å®šè§„åˆ™ï¼ˆjs-this-binding.mdï¼‰