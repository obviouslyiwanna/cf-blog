---
title: Webpack Proxy å·¥ä½œåŸç†ä¸è·¨åŸŸè§£å†³æ–¹æ¡ˆ
description: æœ¬æ–‡æ·±å…¥è®²è§£ webpack-dev-server ä¸­çš„ proxy æ˜¯å¦‚ä½•å·¥ä½œçš„ã€å¦‚ä½•é…ç½®ä»£ç†æœåŠ¡å™¨ï¼Œä»¥åŠå®ƒæ˜¯å¦‚ä½•å¸®åŠ©å¼€å‘ç¯å¢ƒä¸­è§£å†³è·¨åŸŸé—®é¢˜çš„ã€‚
tags: [Webpack, Proxy, è·¨åŸŸ, å‰ç«¯å·¥ç¨‹åŒ–, å¼€å‘ç¯å¢ƒ]
---

# Webpack Proxy å·¥ä½œåŸç†ä¸è·¨åŸŸè§£å†³æ–¹æ¡ˆ

åœ¨å‰ç«¯å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°**æµè§ˆå™¨çš„è·¨åŸŸé™åˆ¶**ã€‚ä¸ºäº†è§£å†³å¼€å‘ç¯å¢ƒä¸‹è·¨åŸŸè¯·æ±‚çš„é—®é¢˜ï¼ŒWebpack æä¾›äº† `devServer.proxy` é…ç½®æ¥è®¾ç½®ä»£ç†ä¸­é—´å±‚ã€‚è¿™ç¯‡æ–‡ç« å°†è¯¦ç»†è®²è§£å…¶ **å·¥ä½œåŸç†ã€é…ç½®æ–¹æ³•åŠèƒŒåçš„æŠ€æœ¯åŸºç¡€**ã€‚

---

## ä¸€ã€ä»€ä¹ˆæ˜¯ Webpack Proxyï¼Ÿ

`webpack-dev-server` å†…ç½®äº†ä¸€ä¸ª**ä¸­é—´ä»£ç†æœåŠ¡å™¨**ï¼Œç”¨äºå°†å‰ç«¯è¯·æ±‚è½¬å‘åˆ°åç«¯æ¥å£ï¼Œé¿å…ç›´æ¥ç”±æµè§ˆå™¨å‘èµ·è·¨åŸŸè¯·æ±‚ã€‚

ä¾‹å¦‚ï¼š

```bash
æµè§ˆå™¨è¯·æ±‚ï¼šhttp://localhost:8080/api/user
å®é™…ä»£ç†åˆ°ï¼š http://api.example.com/user
````

è¿™é¡¹åŠŸèƒ½é€šè¿‡é…ç½® `devServer.proxy` å®ç°ï¼Œå¸¸ç”¨äºå¼€å‘é˜¶æ®µæ¨¡æ‹Ÿç”Ÿäº§ç¯å¢ƒè¯·æ±‚æ¥å£ã€‚

---

## äºŒã€è·¨åŸŸçš„ç”±æ¥

æµè§ˆå™¨å‡ºäºå®‰å…¨è€ƒè™‘ï¼Œå¯ç”¨äº†**åŒæºç­–ç•¥**ï¼ˆSame-Origin Policyï¼‰ï¼Œç¦æ­¢ä¸€ä¸ªåŸŸçš„ç½‘é¡µå»è¯·æ±‚å¦ä¸€ä¸ªåŸŸçš„èµ„æºã€‚

ä¾‹å¦‚ï¼š

```bash
å‰ç«¯ï¼šhttp://localhost:8080
åç«¯ï¼šhttp://api.example.com
```

é»˜è®¤æƒ…å†µä¸‹ï¼Œæµè§ˆå™¨ä¼š**é˜»æ­¢è¿™ç§è·¨åŸŸè¯·æ±‚**ã€‚ä½†åœ¨å¼€å‘é˜¶æ®µï¼Œæˆ‘ä»¬å¹¶ä¸æƒ³æ¯æ¬¡éƒ½è®©åç«¯å¤„ç†è·¨åŸŸï¼Œä»£ç†å°±èƒ½å¾ˆå¥½åœ°è§£å†³è¿™ä¸ªé—®é¢˜ã€‚

---

## ä¸‰ã€Webpack Proxy çš„å·¥ä½œåŸç†

Webpack Proxy æœ¬è´¨ä¸Šæ˜¯é€šè¿‡ `http-proxy-middleware` å®ç°çš„ä¸€ä¸ª **ä¸­é—´å±‚ HTTP è½¬å‘æœåŠ¡**ã€‚

> å®ƒå°†æµè§ˆå™¨åŸæœ¬çš„è·¨åŸŸè¯·æ±‚â€œåŠ«æŒâ€ï¼Œå…ˆå‘ç»™æœ¬åœ° Dev Serverï¼Œç”± Dev Server ä»£ç†åè½¬å‘ç»™ç›®æ ‡æœåŠ¡å™¨ï¼Œè¿™æ ·æµè§ˆå™¨å°±ä¸ä¼šè®¤ä¸ºæ˜¯è·¨åŸŸäº†ã€‚

ğŸ“Œ **å·¥ä½œæµç¨‹å›¾ï¼š**

```text
[Browser] ---> [Webpack Dev Server (proxy)] ---> [Backend API Server]
```

æµè§ˆå™¨ â†’ è¯·æ±‚ localhost:8080/api/user
Webpack Dev Server â†’ æ‹¦æˆª `/api/*` è¯·æ±‚ â†’ è½¬å‘è‡³ [http://api.example.com/user](http://api.example.com/user)
Webpack Dev Server â†’ æ¥æ”¶å“åº” â†’ è¿”å›ç»™æµè§ˆå™¨

ç”±äºä¸€åˆ‡éƒ½æ˜¯å‘ç”Ÿåœ¨æœåŠ¡å™¨ä¹‹é—´ï¼Œæµè§ˆå™¨å§‹ç»ˆåªå’Œ `localhost` é€šä¿¡ï¼Œå› æ­¤**ä¸ä¼šè§¦å‘è·¨åŸŸé™åˆ¶**ã€‚

---

## å››ã€ä»£ç†é…ç½®ç¤ºä¾‹

```js
// webpack.config.js
module.exports = {
  devServer: {
    proxy: {
      '/api': {
        target: 'https://api.example.com', // ä»£ç†ç›®æ ‡åœ°å€
        pathRewrite: { '^/api': '' }, // é‡å†™è·¯å¾„
        secure: false, // æ”¯æŒ https
        changeOrigin: true, // ä¿®æ”¹è¯·æ±‚å¤´ä¸­çš„ origin
      }
    }
  }
};
```

ğŸ“Œ å„é…ç½®å‚æ•°è¯´æ˜ï¼š

| å‚æ•°             | è¯´æ˜                                          |
| -------------- | ------------------------------------------- |
| `target`       | è¦ä»£ç†åˆ°çš„æœåŠ¡åœ°å€                                   |
| `pathRewrite`  | é‡å†™è·¯å¾„ï¼Œé€šå¸¸ç”¨æ¥å»æ‰è·¯å¾„å‰ç¼€ï¼ˆå¦‚ `/api`ï¼‰                   |
| `secure`       | æ˜¯å¦éªŒè¯ SSL è¯ä¹¦ï¼Œé»˜è®¤ `true`ï¼Œæ”¹ä¸º `false` å¯ç”¨äºä»£ç†è‡ªç­¾åè¯ä¹¦ |
| `changeOrigin` | æ˜¯å¦ä¿®æ”¹è¯·æ±‚å¤´ä¸­çš„ `Host` å­—æ®µï¼Œé€šå¸¸è®¾ç½®ä¸º `true` é¿å…è¢«åç«¯æ‹¦æˆª    |

---

## äº”ã€åŸç†å…³é”®ï¼š`http-proxy-middleware`

Webpack Proxy çš„åº•å±‚ä¾èµ–åº“æ˜¯ [`http-proxy-middleware`](https://github.com/chimurai/http-proxy-middleware)ï¼Œå®ƒæ˜¯ä¸€ä¸ªåŸºäº Express çš„ä¸­é—´ä»¶æ¡†æ¶ï¼Œç”¨äºå¤„ç† HTTP è¯·æ±‚ä»£ç†ã€‚

ä½ ä¹Ÿå¯ä»¥åœ¨ Node.js é¡¹ç›®ä¸­å•ç‹¬ä½¿ç”¨è¿™ä¸ªåº“ï¼š

```js
const { createProxyMiddleware } = require('http-proxy-middleware');

app.use('/api', createProxyMiddleware({
  target: 'http://api.example.com',
  changeOrigin: true,
}));
```

---

## å…­ã€å¸¸è§ä½¿ç”¨åœºæ™¯

* æœ¬åœ°å¼€å‘æ—¶å°†æ¥å£è¯·æ±‚ä»£ç†åˆ°è¿œç¨‹æµ‹è¯•ç¯å¢ƒæˆ–æœ¬åœ° mock æœåŠ¡å™¨ï¼›
* å¤šç«¯å¼€å‘ï¼ˆå‰ç«¯ã€åç«¯åˆ†ç¦»ï¼‰æ—¶å¿«é€Ÿè”è°ƒï¼›
* é¿å…é¢‘ç¹è®¾ç½® CORS å“åº”å¤´ï¼›
* å¿«é€Ÿè°ƒè¯•ç¬¬ä¸‰æ–¹æ¥å£ï¼›

---

## ä¸ƒã€æ€»ç»“

| ç‰¹æ€§ | è¯´æ˜                                   |
| -- | ------------------------------------ |
| åŸç† | Webpack Dev Server æ­å»ºä¸­é—´ä»£ç†æœåŠ¡å™¨ï¼Œæ‹¦æˆªå¹¶è½¬å‘è¯·æ±‚ |
| ä¼˜ç‚¹ | æ— éœ€è®¾ç½® CORSï¼Œå¼€å‘ä½“éªŒè‰¯å¥½ï¼Œé…ç½®çµæ´»                |
| å±€é™ | ä»…åœ¨å¼€å‘é˜¶æ®µä½¿ç”¨ï¼Œç”Ÿäº§ç¯å¢ƒå»ºè®®ç”± Nginx æˆ– API ç½‘å…³ä»£ç†    |

---

## ğŸ“Œ å»¶ä¼¸é˜…è¯»

* [Webpack å®˜æ–¹æ–‡æ¡£ - devServer.proxy](https://webpack.js.org/configuration/dev-server/#devserverproxy)
* [http-proxy-middleware GitHub](https://github.com/chimurai/http-proxy-middleware)
